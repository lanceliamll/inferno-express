"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var inferno=require("inferno"),infernoCreateElement=require("inferno-create-element");function _typeof(a){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _objectSpread(a){for(var b=1;b<arguments.length;b++){var c=null==arguments[b]?{}:arguments[b],d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){_defineProperty(a,b,c[b])})}return a}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&_setPrototypeOf(a,b)}function _getPrototypeOf(a){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},_getPrototypeOf(a)}function _setPrototypeOf(a,b){return _setPrototypeOf=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},_setPrototypeOf(a,b)}function _objectWithoutPropertiesLoose(a,b){if(null==a)return{};var c,d,e={},f=Object.keys(a);for(d=0;d<f.length;d++)c=f[d],0<=b.indexOf(c)||(e[c]=a[c]);return e}function _objectWithoutProperties(a,b){if(null==a)return{};var c,d,e=_objectWithoutPropertiesLoose(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(d=0;d<f.length;d++)c=f[d],!(0<=b.indexOf(c))&&Object.prototype.propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e}function _assertThisInitialized(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _possibleConstructorReturn(a,b){return b&&("object"==typeof b||"function"==typeof b)?b:_assertThisInitialized(a)}function addClassName(a,b){if(b)for(var c=b.split(" "),d=0;d<c.length;d++)a.classList.add(c[d])}function removeClassName(a,b){if(b)for(var c=b.split(" "),d=0;d<c.length;d++)a.classList.remove(c[d])}function forceReflow(){document.body.clientHeight}function setDisplay(a,b){var c=a.style.display;return c!==b&&(a.style.display=b),c}function _cleanStyle(a){a.style||a.removeAttribute("style")}function getDimensions(a){var b=a.style.display,c="none"===window.getComputedStyle(a).getPropertyValue("display");c&&(a.style.display="block");var d=a.getBoundingClientRect();return c&&(a.style.display=b,_cleanStyle(a)),{width:d.width,height:d.height}}function setDimensions(a,b,c){a.style.width=b+"px",a.style.height=c+"px"}function clearDimensions(a){a.style.width=a.style.height=""}function animationIsRunningOnParent(a){return a.closest&&a.closest(".InfernoAnimation--noAnim")}function _getMaxTransitionDuration(){for(var a,b=arguments,c=0,d=0,e=function(a){var e=b[a];if(!e)return"continue";var f=window.getComputedStyle(e),g=f.getPropertyValue("transition-duration").split(","),h=f.getPropertyValue("transition-delay").split(","),i=f.getPropertyValue("transition-property").split(",").map(function(a){return a.trim()});i.forEach(function(a){if("-"===a[0]){var b=a.split("-").splice(2).join("-");0<=i.indexOf(b)&&c--}});var j=g.map(function(a,b){return parseFloat(a)+parseFloat(h[b])}).reduce(function(a,b){return a>b?a:b},0);c+=g.length,j>d&&(d=j)},f=0;f<arguments.length;f++)a=e(f),"continue"===a;return{nrofTransitions:c,maxDuration:d}}function registerTransitionListener(a,b){function c(e){if(e){for(var g=!1,j=0;j<a.length;j++)if(e.target===a[j]){g=!0;break}if(!g)return}h||void 0!==e&&0<--f||(h=!0,d.classList.remove("InfernoAnimation-active"),d.removeEventListener("transitionend",c,!1),b&&b())}Array.isArray(a)||(a=[a]);var d=a[0];d.classList.add("InfernoAnimation-active");var e=_getMaxTransitionDuration.apply(this,a),f=e.nrofTransitions,g=e.maxDuration,h=!1;d.addEventListener("transitionend",c,!1),window.debugAnimations||setTimeout(c,Math.round(1e3*g)+100)}var animateOnRemove=function(a,b,c){if(!animationIsRunningOnParent(a)){var d={};"object"===_typeof(b)?d=b:(d.start=b+"-leave",d.active=b+"-leave-active",d.end=b+"-leave-end");var e=a.cloneNode(!0),f=getDimensions(a),g=f.width,h=f.height;setDimensions(e,g,h),addClassName(e,d.start),setDisplay(a,"none !important"),a.insertAdjacentElement("beforebegin",e),registerTransitionListener(e,function(){c&&c(e),e.remove()}),addClassName(e,d.active),setTimeout(function(){addClassName(e,d.end),removeClassName(e,d.start),clearDimensions(e)},5)}},animateOnAdd=function(a,b,c){if(!animationIsRunningOnParent(a)){var d={};"object"===_typeof(b)?d=b:(d.start=b+"-enter",d.active=b+"-enter-active",d.end=b+"-enter-end");var e=getDimensions(a),f=e.width,g=e.height;addClassName(a,d.start),forceReflow(),registerTransitionListener([a,a.children[0]],function(){clearDimensions(a),removeClassName(a,d.active),removeClassName(a,d.end),c&&c(a)}),addClassName(a,d.active),setTimeout(function(){setDimensions(a,f,g),removeClassName(a,d.start),addClassName(a,d.end)},5)}};function OriginalAnimated(a){var b=a.el,c=a.tag,d=a.children,e=_objectWithoutProperties(a,["el","tag","children"]);return infernoCreateElement.createElement(c||b||"div",e,d)}function Animated(a){var b=a.prefix,c=a.onDidEnter,d=a.onDidLeave,e=_objectWithoutProperties(a,["prefix","onDidEnter","onDidLeave"]);return inferno.normalizeProps(inferno.createComponentVNode(2,OriginalAnimated,_objectSpread({},e),null,{onComponentDidMount:function(a){return animateOnAdd(a,b,c)},onComponentWillUnmount:function(a){return animateOnRemove(a,b,d)}}))}function findDOMNode(a){return a&&a.nodeType?a:!a||a.$UN?null:a.$LI?inferno.findDOMfromVNode(a.$LI,!0):a.flags?inferno.findDOMfromVNode(a,!0):null}var animateSizeChange=function(a,b,c,d){animationIsRunningOnParent(a)||(setDimensions(a,c.width,c.height),forceReflow(a),registerTransitionListener(a,function(){clearDimensions(a),a.classList.remove(b+"-cross-fade-active")}),a.classList.add(b+"-cross-fade-active"),setTimeout(function(){setDimensions(a,d.width,d.height)},5))};function _getSizeOfCrossFadeDOMNode(a){var b=a.parentNode;b.classList.add("InfernoAnimation--getSize"),forceReflow(b);var c=getDimensions(b);return b.classList.remove("InfernoAnimation--getSize"),c}var CrossFade=function(a){function b(a){var c;return _classCallCheck(this,b),c=_possibleConstructorReturn(this,_getPrototypeOf(b).call(this,a)),c.state={active:!1},c.setTargetSize=c.setTargetSize.bind(_assertThisInitialized(_assertThisInitialized(c))),c.setSourceSize=c.setSourceSize.bind(_assertThisInitialized(_assertThisInitialized(c))),c._animationCheck=c._animationCheck.bind(_assertThisInitialized(_assertThisInitialized(c))),c}return _inherits(b,a),_createClass(b,[{key:"_animationCheck",value:function(){this.state.active&&this.targetSize&&this.sourceSize&&findDOMNode(this)&&(animateSizeChange(findDOMNode(this),this.props.prefix,this.sourceSize,this.targetSize),this.targetSize=this.sourceSize=void 0)}},{key:"componentDidMount",value:function(){var a=this;setTimeout(function(){a.targetSize=a.sourceSize=void 0,a.setState({active:!0})},10)}},{key:"setTargetSize",value:function(a){this.targetSize=_getSizeOfCrossFadeDOMNode(a),this._animationCheck()}},{key:"setSourceSize",value:function(a){this.sourceSize=_getSizeOfCrossFadeDOMNode(a),this._animationCheck()}},{key:"render",value:function(){var a=this,b={};this.props.className?b.className=this.props.className+(this.state.active?"":" InfernoAnimation--noAnim"):!this.state.active&&(b.className="InfernoAnimation--noAnim");var c=Array.isArray(this.props.children)?this.props.children:[this.props.children],d=c.map(function(b){return infernoCreateElement.createElement(CrossFadeItem,{onEnter:a.setTargetSize,onLeave:a.setSourceSize,key:b&&b.key,prefix:a.props.prefix},b)});return infernoCreateElement.createElement(this.props.el||this.props.tag||"div",b,d)}}]),b}(inferno.Component),CrossFadeItem=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,_getPrototypeOf(b).apply(this,arguments))}return _inherits(b,a),_createClass(b,[{key:"componentDidMount",value:function(){var a=this,b=findDOMNode(this);this.props.onEnter(b),setTimeout(function(){return animateOnAdd(b,a.props.prefix)})}},{key:"componentWillUnmount",value:function(){var a=this,b=findDOMNode(this);this.props.onLeave(b),setTimeout(function(){return animateOnRemove(b,a.props.prefix)})}},{key:"render",value:function(){return inferno.createVNode(1,"div","CrossFadeItem",this.props.children,0)}}]),b}(inferno.Component),utils={addClassName:addClassName,animationIsRunningOnParent:animationIsRunningOnParent,removeClassName:removeClassName,registerTransitionListener:registerTransitionListener,forceReflow:forceReflow,clearDimensions:clearDimensions,getDimensions:getDimensions,setDimensions:setDimensions,setDisplay:setDisplay};exports.utils=utils,exports.Animated=Animated,exports.CrossFade=CrossFade,exports.animateOnRemove=animateOnRemove,exports.animateOnAdd=animateOnAdd;
//# sourceMappingURL=index.min.js.map
