{"version":3,"file":"index.js","sources":["../../src/utils.js","../../src/animatedComponent.js","../../src/Animated.js","../../node_modules/inferno-extras/dist/index.esm.js","../../src/CrossFade.js","../../src/index.js"],"sourcesContent":["export function addClassName (node, className) {\n  if (className) {\n    const tmp = className.split(' ')\n    for (let i=0; i < tmp.length; i++) {\n      node.classList.add(tmp[i])\n    }\n  }\n}\n\nexport function removeClassName (node, className) {\n  if (className) {\n    const tmp = className.split(' ')\n    for (let i=0; i < tmp.length; i++) {\n      node.classList.remove(tmp[i])\n    }\n  }\n}\n\nexport function forceReflow () {\n  var dummy = document.body.clientHeight\n}\n\nexport function setDisplay(node, value) {\n  var oldVal = node.style.display\n  if (oldVal !== value) {\n    node.style.display = value\n  }\n  return oldVal\n}\n\nfunction _cleanStyle(node) {\n  if (!node.style) {\n    node.removeAttribute('style')\n  }\n}\n\nexport function getDimensions(node) {\n  var tmpDisplay = node.style.display\n  var isDisplayNone = window.getComputedStyle(node).getPropertyValue('display') === 'none'\n  if (isDisplayNone) {\n    node.style.display = 'block'\n  }\n  \n  var tmp = node.getBoundingClientRect()\n\n  if (isDisplayNone) {\n    node.style.display = tmpDisplay\n    _cleanStyle(node)\n  }\n\n  return {\n    width: tmp.width,\n    height: tmp.height\n  }\n}\n\nexport function setDimensions(node, width, height) {\n  node.style.width = width + 'px'\n  node.style.height = height + 'px'\n}\n\nexport function clearDimensions(node) {\n  node.style.width = node.style.height = ''\n}\n\nexport function animationIsRunningOnParent(node) {\n  return (node.closest && node.closest('.InfernoAnimation--noAnim'))\n}\n\nfunction _getMaxTransitionDuration (/* add nodes as args*/) {\n  let nrofTransitions = 0\n  let maxDuration = 0\n  for (let i=0; i < arguments.length; i++) {\n    const node = arguments[i]\n    if (!node) continue\n\n    const cs = window.getComputedStyle(node)\n    const dur = cs.getPropertyValue('transition-duration').split(',')\n    const del = cs.getPropertyValue('transition-delay').split(',')\n    const props = cs.getPropertyValue('transition-property').split(',').map((prop) => prop.trim())\n    props.forEach((prop) => {\n      if (prop[0] === '-') {\n        let tmp = prop.split('-').splice(2).join('-')\n        if (props.indexOf(tmp) >= 0) {\n          nrofTransitions--\n        }\n      }\n    })\n    const animTimeout = dur.map((v, index) => parseFloat(v) + parseFloat(del[index])).reduce((prev, curr) => prev > curr ? prev : curr, 0)\n\n    nrofTransitions += dur.length\n    if (animTimeout > maxDuration) {\n      maxDuration = animTimeout\n    }\n  }\n  \n  return {\n    nrofTransitions: nrofTransitions,\n    maxDuration: maxDuration\n  }\n}\n\nexport function registerTransitionListener(nodes, callback) {\n  if (!Array.isArray(nodes)) {\n    nodes = [nodes]\n  }\n  const rootNode = nodes[0]\n\n  rootNode.classList.add('InfernoAnimation-active')\n\n  /**\n   * Here comes the transition event listener\n   */ \n  let { nrofTransitions: nrofTransitionsLeft, maxDuration } = _getMaxTransitionDuration.apply(this, nodes)\n  let done = false\n\n  function onTransitionEnd (event) {\n    // Make sure it isn't a child that is triggering the event\n    if (event) {\n      var goAhead = false\n      for (var i=0; i < nodes.length; i++) {\n        if (event.target === nodes[i]) {\n          goAhead = true\n          break\n        }\n      }\n      if (!goAhead) return\n    }\n\n    if (done || (event !== undefined && --nrofTransitionsLeft > 0)) {\n      return\n    }\n    done = true\n    rootNode.classList.remove('InfernoAnimation-active')\n    \n    /**\n     * Perform cleanup\n     */ \n    rootNode.removeEventListener(\"transitionend\", onTransitionEnd, false)\n    callback && callback()\n  }\n  rootNode.addEventListener(\"transitionend\", onTransitionEnd, false)\n  // Fallback if transitionend fails\n  !window.debugAnimations && setTimeout(onTransitionEnd, Math.round(maxDuration * 1000) + 100) \n}\n","import {\n  addClassName,\n  animationIsRunningOnParent,\n  removeClassName,\n  registerTransitionListener,\n  forceReflow,\n  clearDimensions,\n  getDimensions,\n  setDimensions,\n  setDisplay\n} from './utils'\n\nexport const animateOnRemove = function (node, animationName, callback) {\n  if (animationIsRunningOnParent(node)) return\n\n  let animCls = {}\n  if (typeof animationName === 'object') {\n    animCls = animationName\n  } else {\n    animCls['start'] = animationName + '-leave'\n    animCls['active'] = animationName + '-leave-active'\n    animCls['end'] = animationName + '-leave-end'\n  }\n\n  // 1. Clone DOM node, inject it and hide original\n  const clone = node.cloneNode(true)\n  const { width, height } = getDimensions(node)\n  setDimensions(clone, width, height)\n  addClassName(clone, animCls.start)\n  // Leaving original element so it can be removed in the normal way\n  setDisplay(node, 'none !important')\n  node.insertAdjacentElement('beforebegin', clone)\n\n  // 2. Set an animation listener, code at end\n  registerTransitionListener(clone, function () {\n    // *** Cleanup ***\n    callback && callback(clone)\n    clone.remove()\n  })\n\n  // 3. Activate transitions\n  addClassName(clone, animCls.active)\n\n  // 4. Activate target state\n  setTimeout(() => {\n    addClassName(clone, animCls.end)\n    removeClassName(clone, animCls.start)\n    clearDimensions(clone)\n  }, 5)\n}\n\nexport const animateOnAdd = function (node, animationName, callback) {\n  if (animationIsRunningOnParent(node)) return\n\n  let animCls = {}\n  if (typeof animationName === 'object') {\n    animCls = animationName\n  } else {\n    animCls['start'] = animationName + '-enter'\n    animCls['active'] = animationName + '-enter-active'\n    animCls['end'] = animationName + '-enter-end'\n  }\n\n  // 1. Get height and set start of animation\n  const { width, height } = getDimensions(node)\n  addClassName(node, animCls.start)\n  forceReflow()\n\n  // 2. Set an animation listener, code at end\n  registerTransitionListener([node, node.children[0]], function () {\n    // *** Cleanup ***\n    // 5. Remove the element\n    clearDimensions(node)\n    removeClassName(node, animCls.active)\n    removeClassName(node, animCls.end)\n    \n    // 6. Call callback to allow stuff to happen\n    callback && callback(node)\n  })\n\n  // 3. Activate transition\n  addClassName(node, animCls.active)\n \n  // 4. Activate target state\n  setTimeout(() => {\n    setDimensions(node, width, height)\n    removeClassName(node, animCls.start)\n    addClassName(node, animCls.end)\n  }, 5)\n}\n","import { createElement } from 'inferno-create-element'\nimport { animateOnAdd, animateOnRemove } from './animatedComponent'\n\nfunction OriginalAnimated ({ el, tag, children, ...attrs}) {\n  return createElement(\n    tag || el || 'div', \n    attrs, \n    children\n  )\n}\n\nfunction Animated ({ prefix, onDidEnter, onDidLeave, ...attrs}) {\n\n  return <OriginalAnimated {...attrs}\n    onComponentDidMount={(dom) => animateOnAdd(dom, prefix, onDidEnter)}\n    onComponentWillUnmount={(dom) => animateOnRemove(dom, prefix, onDidLeave)} />\n}\n\nexport default Animated\n\n/*\n\n// Why did this not work?\n\n'use strict'\nimport { Component } from 'inferno'\nimport { createElement } from 'inferno-create-element'\nimport { animateOnAdd, animateOnRemove } from './animatedComponent'\n\nfunction Animated ({ el, tag, prefix, onDidEnter, onDidLeave, children, ...attrs}) {\n\n  attrs.onComponentDidMount = (dom) => animateOnAdd(dom, prefix, onDidEnter)\n  attrs.onComponentWillUnmount = (dom) => animateOnRemove(dom, prefix, onDidLeave)\n\n  return createElement(\n    tag || el || 'div', \n    attrs, \n    children\n  )\n}\n\nexport default Animated\n\n*/","import { findDOMfromVNode } from 'inferno';\n\nfunction isDOMinsideVNode(DOM, vNode) {\n    var stack = [vNode];\n    var _vNode;\n    var flags;\n    var children;\n    while (stack.length > 0) {\n        _vNode = stack.pop();\n        if (_vNode.dom === DOM) {\n            return true;\n        }\n        flags = _vNode.flags;\n        children = _vNode.children;\n        if (flags & 4 /* ComponentClass */) {\n            stack.push(children.$LI);\n        }\n        else if (flags & 8 /* ComponentFunction */) {\n            stack.push(children);\n        }\n        else {\n            flags = _vNode.childFlags;\n            if (flags & 12 /* MultipleChildren */) {\n                var i = children.length;\n                while (i--) {\n                    stack.push(children[i]);\n                }\n            }\n            else if (flags & 2 /* HasVNodeChildren */) {\n                stack.push(children);\n            }\n        }\n    }\n    return false;\n}\nfunction isDOMinsideComponent(DOM, instance) {\n    if (instance.$UN) {\n        return false;\n    }\n    return isDOMinsideVNode(DOM, instance.$LI);\n}\n\nfunction findDOMNode(ref) {\n    if (ref && ref.nodeType) {\n        return ref;\n    }\n    if (!ref || ref.$UN) {\n        return null;\n    }\n    if (ref.$LI) {\n        return findDOMfromVNode(ref.$LI, true);\n    }\n    if (ref.flags) {\n        return findDOMfromVNode(ref, true);\n    }\n    return null;\n}\n\nexport { findDOMNode, isDOMinsideVNode, isDOMinsideComponent };\n","import { Component } from 'inferno'\nimport { createElement } from 'inferno-create-element'\nimport { findDOMNode } from 'inferno-extras'\nimport { animateOnAdd, animateOnRemove } from './animatedComponent'\n\nimport {\n  animationIsRunningOnParent,\n  registerTransitionListener,\n  forceReflow,\n  clearDimensions,\n  getDimensions,\n  setDimensions\n} from './utils'\n\nconst animateSizeChange = function (node, animationName, sourceSize, targetSize) {\n  if (animationIsRunningOnParent(node)) return\n\n  // 1. Set dimensions\n  setDimensions(node, sourceSize.width, sourceSize.height)\n  // node.style.height = sourceSize.height + 'px'\n  // node.style.width = sourceSize.width + 'px'\n  forceReflow(node)\n\n  // 2. Set an animation listener, code at end\n  registerTransitionListener(node, function () {\n    // *** Cleanup ***\n    // callback && callback(clone)\n    clearDimensions(node)\n    node.classList.remove(animationName + '-cross-fade-active')\n  })\n\n  // 3. Activate transition\n  node.classList.add(animationName + '-cross-fade-active')\n  \n  // 4. Activate target state\n  setTimeout(() => {\n    setDimensions(node, targetSize.width, targetSize.height)\n  }, 5)\n}\n\nfunction _getSizeOfCrossFadeDOMNode (DOMNode) {\n  const domEl = DOMNode.parentNode\n  domEl.classList.add('InfernoAnimation--getSize')\n  forceReflow(domEl)\n  const outpDimensions = getDimensions(domEl)\n  domEl.classList.remove('InfernoAnimation--getSize')\n  return outpDimensions\n}\n\nclass CrossFade extends Component {\n  constructor (props) {\n    super(props)\n\n    this.state = {\n      active: false\n    }\n    \n    this.setTargetSize = this.setTargetSize.bind(this)\n    this.setSourceSize = this.setSourceSize.bind(this)\n    this._animationCheck = this._animationCheck.bind(this)\n  }\n\n  _animationCheck () {\n    if (this.state.active && this.targetSize && this.sourceSize && findDOMNode(this)) {\n      animateSizeChange(findDOMNode(this), this.props.prefix, this.sourceSize, this.targetSize)\n      this.targetSize = this.sourceSize = undefined\n    }\n  }\n\n  componentDidMount () {\n    setTimeout(() => {\n      this.targetSize = this.sourceSize = undefined\n      this.setState({\n        active: true\n      })\n    }, 10)\n  }\n\n  setTargetSize (DOMNode) {\n    this.targetSize = _getSizeOfCrossFadeDOMNode(DOMNode)\n    this._animationCheck()\n  }\n\n  setSourceSize (DOMNode) {\n    this.sourceSize = _getSizeOfCrossFadeDOMNode(DOMNode)\n    this._animationCheck()\n  }\n\n  render () {\n    const elProps = {}\n    if (this.props.className) {\n      // Using 'InfernoAnimation--noAnim' to block animations in children\n      elProps['className'] = this.props.className + (!this.state.active ? ' InfernoAnimation--noAnim' : '')\n    } else if (!this.state.active) {\n      elProps['className'] = 'InfernoAnimation--noAnim'\n    }\n    \n    const children = (!Array.isArray(this.props.children) ? [this.props.children] : this.props.children)\n\n    const childEls = children.map((childEl) => createElement(CrossFadeItem, {\n      // onComponentDidMount: this.setTargetSize, onComponentWillUnmount: this.setSourceSize, key: childEl.key\n      onEnter: this.setTargetSize, onLeave: this.setSourceSize, key: childEl && childEl.key, prefix: this.props.prefix\n    }, childEl))  \n\n    return createElement(\n      this.props.el || this.props.tag || 'div', \n      elProps, \n      childEls\n    )\n  }\n}\n\n/*\nfunction CrossFadeItem (props) {\n  return (\n    <div className=\"CrossFadeItem\">\n      {props.children}\n    </div>\n  )\n}\n*/\n\nclass CrossFadeItem extends Component {\n\n  componentDidMount () {\n    const node = findDOMNode(this)\n    this.props.onEnter(node)\n    setTimeout(() => animateOnAdd(node, this.props.prefix))\n  }\n\n  componentWillUnmount () {\n    const node = findDOMNode(this)\n    this.props.onLeave(node)\n    setTimeout(() => animateOnRemove(node, this.props.prefix))\n  }\n\n  render () {\n    return (\n      <div className=\"CrossFadeItem\">\n        {this.props.children}\n      </div>\n    )\n  }\n}\n\n\nexport default CrossFade\n","export { default as Animated } from './Animated'\nexport { default as CrossFade } from './CrossFade'\nexport { animateOnRemove, animateOnAdd } from './animatedComponent'\nimport {\n  addClassName,\n  animationIsRunningOnParent,\n  removeClassName,\n  registerTransitionListener,\n  forceReflow,\n  clearDimensions,\n  getDimensions,\n  setDimensions,\n  setDisplay\n} from './utils'\n\nexport const utils = {\n  addClassName,\n  animationIsRunningOnParent,\n  removeClassName,\n  registerTransitionListener,\n  forceReflow,\n  clearDimensions,\n  getDimensions,\n  setDimensions,\n  setDisplay\n}\n"],"names":["addClassName","node","className","tmp","split","i","length","classList","add","removeClassName","remove","forceReflow","dummy","document","body","clientHeight","setDisplay","value","oldVal","style","display","_cleanStyle","removeAttribute","getDimensions","tmpDisplay","isDisplayNone","window","getComputedStyle","getPropertyValue","getBoundingClientRect","width","height","setDimensions","clearDimensions","animationIsRunningOnParent","closest","_getMaxTransitionDuration","nrofTransitions","maxDuration","arguments","cs","dur","del","props","map","prop","trim","forEach","splice","join","indexOf","animTimeout","v","index","parseFloat","reduce","prev","curr","registerTransitionListener","nodes","callback","Array","isArray","rootNode","apply","nrofTransitionsLeft","done","onTransitionEnd","event","goAhead","target","undefined","removeEventListener","addEventListener","debugAnimations","setTimeout","Math","round","animateOnRemove","animationName","animCls","clone","cloneNode","start","insertAdjacentElement","active","end","animateOnAdd","children","OriginalAnimated","el","tag","attrs","createElement","Animated","prefix","onDidEnter","onDidLeave","dom","findDOMNode","ref","nodeType","$UN","$LI","findDOMfromVNode","flags","animateSizeChange","sourceSize","targetSize","_getSizeOfCrossFadeDOMNode","DOMNode","domEl","parentNode","outpDimensions","CrossFade","state","setTargetSize","bind","setSourceSize","_animationCheck","setState","elProps","childEls","childEl","CrossFadeItem","onEnter","onLeave","key","Component","utils"],"mappings":"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"}