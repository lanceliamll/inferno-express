"use strict";Object.defineProperty(exports,"__esModule",{value:!0});function _interopDefault(a){return a&&"object"==typeof a&&"default"in a?a["default"]:a}var inferno=require("inferno"),infernoCreateElement=require("inferno-create-element"),PopperJS=_interopDefault(require("popper.js"));function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _objectSpread(a){for(var b=1;b<arguments.length;b++){var c=null==arguments[b]?{}:arguments[b],d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){_defineProperty(a,b,c[b])})}return a}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&_setPrototypeOf(a,b)}function _getPrototypeOf(a){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},_getPrototypeOf(a)}function _setPrototypeOf(a,b){return _setPrototypeOf=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},_setPrototypeOf(a,b)}function _objectWithoutPropertiesLoose(a,b){if(null==a)return{};var c,d,e={},f=Object.keys(a);for(d=0;d<f.length;d++)c=f[d],0<=b.indexOf(c)||(e[c]=a[c]);return e}function _objectWithoutProperties(a,b){if(null==a)return{};var c,d,e=_objectWithoutPropertiesLoose(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(d=0;d<f.length;d++)c=f[d],!(0<=b.indexOf(c))&&Object.prototype.propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e}function _assertThisInitialized(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _possibleConstructorReturn(a,b){return b&&("object"==typeof b||"function"==typeof b)?b:_assertThisInitialized(a)}var Manager=function(a){function b(a){var c;return _classCallCheck(this,b),c=_possibleConstructorReturn(this,_getPrototypeOf(b).call(this,a)),c._setTargetNode=function(a){c._targetNode=a},c._getTargetNode=function(){return c._targetNode},c}return _inherits(b,a),_createClass(b,[{key:"getChildContext",value:function(){return{popperManager:{setTargetNode:this._setTargetNode,getTargetNode:this._getTargetNode}}}},{key:"render",value:function(){var a=this.props,b=a.tag,c=a.children,d=_objectWithoutProperties(a,["tag","children"]);return!1===b?c:infernoCreateElement.createElement(b||"div",d,c)}}]),b}(inferno.Component),Target=function(a,b){var c=a.component,d=void 0===c?"div":c,e=a.innerRef,f=a.children,g=_objectWithoutProperties(a,["component","innerRef","children"]),h=b.popperManager,i=function(a){h.setTargetNode(a),"function"==typeof e&&e(a)};if("function"==typeof f){return f({targetProps:{ref:i},restProps:g})}var j=_objectSpread({},g);return"string"==typeof d?j.ref=i:j.innerRef=i,infernoCreateElement.createElement(d,j,f)},placements=PopperJS.placements,defaultProps={component:"div",placement:"bottom",eventsEnabled:!0,positionFixed:!1,modifiers:{}},Popper=function(a){function b(){var a,c;_classCallCheck(this,b);for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=_possibleConstructorReturn(this,(a=_getPrototypeOf(b)).call.apply(a,[this].concat(e))),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"state",{}),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"_updateStateModifier",{enabled:!0,order:900,fn:function(a){return c._isDataDirty(a)&&c.setState({data:a}),a}}),_defineProperty(_assertThisInitialized(_assertThisInitialized(c)),"_handlePopperRef",function(a){c._popperNode=a,a?c._createPopper():c._destroyPopper(),c.props.innerRef&&c.props.innerRef(a)}),c}return _inherits(b,a),_createClass(b,[{key:"getChildContext",value:function(){return{popper:{setArrowNode:this._setArrowNode.bind(this),getArrowStyle:this._getArrowStyle.bind(this)}}}},{key:"componentDidUpdate",value:function(a){(a.placement!==this.props.placement||a.eventsEnabled!==this.props.eventsEnabled||a.target!==this.props.target)&&(this._destroyPopper(),this._createPopper()),a.children!==this.props.children&&this._popper.scheduleUpdate()}},{key:"componentWillUnmount",value:function(){this._destroyPopper()}},{key:"_setArrowNode",value:function(a){this._arrowNode=a}},{key:"_getTargetNode",value:function(){if(this.props.target)return this.props.target;if(!this.context.popperManager||!this.context.popperManager.getTargetNode())throw new Error("Target missing. Popper must be given a target from the Popper Manager, or as a prop.");return this.context.popperManager.getTargetNode()}},{key:"_getOffsets",value:function(a){return Object.keys(a.offsets).map(function(b){return a.offsets[b]})}},{key:"_isDataDirty",value:function(a){return!this.state.data||JSON.stringify(this._getOffsets(this.state.data))!==JSON.stringify(this._getOffsets(a))}},{key:"_createPopper",value:function(){var a=this,b=this.props,c=b.placement,d=b.eventsEnabled,e=b.positionFixed,f=_objectSpread({},this.props.modifiers,{applyStyle:{enabled:!1},updateState:this._updateStateModifier});this._arrowNode&&(f.arrow=_objectSpread({},this.props.modifiers.arrow||{},{element:this._arrowNode})),this._popper=new PopperJS(this._getTargetNode(),this._popperNode,{placement:c,positionFixed:e,eventsEnabled:d,modifiers:f}),setTimeout(function(){return a._scheduleUpdate()})}},{key:"_destroyPopper",value:function(){this._popper&&this._popper.destroy()}},{key:"_getPopperStyle",value:function(){var a=this.state.data;return this._popper&&a?_objectSpread({position:a.offsets.popper.position},a.styles):{position:"absolute",pointerEvents:"none",opacity:0}}},{key:"_getPopperPlacement",value:function(){return this.state.data?this.state.data.placement:void 0}},{key:"_getPopperHide",value:function(){return!!this.state.data&&this.state.data.hide?"":void 0}},{key:"_getArrowStyle",value:function(){if(!this.state.data||!this.state.data.offsets.arrow)return{};var a=this.state.data.offsets.arrow,b=a.top,c=a.left;return{top:b,left:c}}},{key:"_scheduleUpdate",value:function(){this._popper&&this._popper.scheduleUpdate()}},{key:"render",value:function(){var a=this.props,b=a.component,c=a.innerRef,d=a.placement,e=a.eventsEnabled,f=a.positionFixed,g=a.modifiers,h=a.children,i=_objectWithoutProperties(a,["component","innerRef","placement","eventsEnabled","positionFixed","modifiers","children"]);b=b||"div",d=d||"bottom",g=g||{};var j=this._getPopperStyle(),k=this._getPopperPlacement(),l=this._getPopperHide();if("function"==typeof h){var m={ref:this._handlePopperRef,style:j,"data-placement":k,"data-x-out-of-boundaries":l};return h({popperProps:m,restProps:i,scheduleUpdate:this._scheduleUpdate})}var n=_objectSpread({},i,{style:_objectSpread({},i.style,j),"data-placement":k,"data-x-out-of-boundaries":l});return"string"==typeof b?n.ref=this._handlePopperRef:n.innerRef=this._handlePopperRef,infernoCreateElement.createElement(b,n,h)}}]),b}(inferno.Component);Popper.defaultProps=defaultProps;var Arrow=function(a,b){var c=a.component,d=void 0===c?"span":c,e=a.innerRef,f=a.children,g=_objectWithoutProperties(a,["component","innerRef","children"]),h=b.popper,i=function(a){h.setArrowNode(a),"function"==typeof e&&e(a)},j=h.getArrowStyle();if("function"==typeof f){return f({arrowProps:{ref:i,style:j},restProps:g})}var k=_objectSpread({},g,{style:_objectSpread({},j,g.style)});return"string"==typeof d?k.ref=i:k.innerRef=i,infernoCreateElement.createElement(d,k,f)},isArray=Array.isArray;function isNullOrUndef(a){return isUndefined(a)||isNull(a)}function isNull(a){return null===a}function isUndefined(a){return void 0===a}var ARR=[],Children={only:function(a){if(a=Children.toArray(a),1!==a.length)throw new Error("Children.only() expects only one child.");return a[0]},toArray:function(a){if(isNullOrUndef(a))return[];if(isArray(a)){var b=[];return flatten(a,b),b}return ARR.concat(a)}},noop=function(){return null},Travel=function(a){function b(a){var c;return _classCallCheck(this,b),c=_possibleConstructorReturn(this,_getPrototypeOf(b).call(this,a)),c.state={portalNode:null,portalInstance:null},c}return _inherits(b,a),_createClass(b,[{key:"componentDidMount",value:function(){this._setupPortal()}},{key:"componentDidUpdate",value:function(){this._updatePortal()}},{key:"componentWillUnmount",value:function(){this._destroyPortal()}},{key:"_getRenderToNode",value:function(){var a=this.props.renderTo;return"string"==typeof a?document.querySelector(a):a||document.body}},{key:"_getComponent",value:function(){return this.props.useArray?Children.toArray(this.props.children)[1]:Children.only(this.props.children)}},{key:"_setupPortal",value:function(){var a=this.props,b=a.renderTag,c=a.onMount;b=b||"div",c=c||noop;var d=this._getRenderToNode(),e=document.createElement(b);d.appendChild(e);var f="function"==typeof c?c(e):e;this.setState({portalNode:e,portalInstance:f})}},{key:"_updatePortal",value:function(){var a=this,b=this.props,c=b.id,d=b.className,e=b.style,f=b.onUpdate;f=f||noop,c&&(this._portalNode.id=c),d&&(this._portalNode.className=d),e&&Object.keys(e).forEach(function(b){a._portalNode.style[b]=e[b]}),"function"==typeof f&&(this._portalInstance=f(this._portalInstance))}},{key:"_destroyPortal",value:function(){this.state.portalNode.parentNode.removeChild(this._portalNode),this.setState({portalNode:null,portalInstance:null})}},{key:"render",value:function(){return this.state.portalNode?inferno.createPortal(this._getComponent(),this.state.portalNode):null}}]),b}(inferno.Component);exports.Manager=Manager,exports.Target=Target,exports.Popper=Popper,exports.placements=placements,exports.Arrow=Arrow,exports.Travel=Travel;
//# sourceMappingURL=index.min.js.map
